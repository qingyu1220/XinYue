/*! YunHou 2016-11-04 */
!function(){var calc=function(){var docElement=document.documentElement,clientWidthValue=docElement.clientWidth>480?480:docElement.clientWidth;docElement.style.fontSize=100*(clientWidthValue/360)+"px"};calc(),window.addEventListener("resize",calc)}();var app=angular.module("myApp",["ui.router"]);app.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){
// 默认界面
$urlRouterProvider.when("","/home/homeWraper/monkeyGlobal").otherwise("home"),
// $urlRouterProvider.otherwise('home.homeWraper.monkeyGlobal')
// 登录界面
$stateProvider.state("login",{url:"/login",templateUrl:"views/login.html"}).state("home",{url:"/home",controller:"homeController",templateUrl:"views/home.html"}).state("sort",{url:"/sort",templateUrl:"views/sort.html",controller:"sortController"}).state("car",{url:"/car",templateUrl:"views/car.html",controller:"carController"}).state("mine",{url:"/mine",templateUrl:"views/mine.html",controller:"mineController"}).state("home.homeWraper",{url:"/homeWraper",templateUrl:"views/homeWraper.html"}).state("home.homeWraper.monkeyGlobal",{url:"/monkeyGlobal",templateUrl:"views/monkeyGlobal.html",controller:"homeController"}).state("home.homeWraper.monkeyEle",{url:"/monkeyEle",templateUrl:"views/monkeyEle.html",controller:"freshController"}).state("home.homeWraper.monkeyFre",{url:"/monkeyFre",templateUrl:"views/monkeyFre.html",controller:"freshController"}).state("allOrders",{url:"/allOrders",templateUrl:"views/allOrders.html",controller:"allOrdersController"}).state("allOrders.all",{url:"/all",templateUrl:"views/all.html"}).state("allOrders.pay",{url:"/pay",templateUrl:"views/pay.html"}).state("allOrders.send",{url:"/send",templateUrl:"views/send.html"}).state("allOrders.take",{url:"/take",templateUrl:"views/take.html"}).state("score",{url:"/score",templateUrl:"views/score.html",controller:"scoreController"}).state("score.you",{url:"/you",templateUrl:"views/you.html",controller:"youController"}).state("score.history",{url:"/history",templateUrl:"views/history.html",controller:"historyController"}).state("collect",{url:"/collect",templateUrl:"views/collect.html",controller:"collectController"}).state("collect.collectOne",{url:"/collectOne",templateUrl:"views/collectOne.html"}).state("collect.collectTwo",{url:"/collectTwo",templateUrl:"views/collectTwo.html"}).state("carEmpty",{url:"/carEmpty",templateUrl:"views/carEmpty.html",controller:"carEmptyController"}).state("itemDetail",{url:"/itemDetail",css:"public/css/itemDetail.css",controller:"itemDetailController",templateUrl:"views/itemDetail.html"}).state("impress",{url:"/impress",templateUrl:"views/impress.html"}).state("girlLuggage",{url:"/girlLuggage",templateUrl:"views/girlLuggage.html"}).state("popularity",{url:"/popularity",templateUrl:"views/popularity.html",controller:"popularityController"}).state("new",{url:"/new",templateUrl:"views/thenew.html",controller:"newController"}).state("goodStore",{url:"/goodStore",templateUrl:"views/goodStore.html"}).state("selfStore",{url:"/selfStore",templateUrl:"views/selfStore.html"}).state("address",{url:"/address",templateUrl:"views/address.html",controller:"addressController"}).state("rush",{url:"/rush",templateUrl:"views/rush.html",controller:"rushController"}).state("searchPage",{url:"/searchPage",templateUrl:"views/searchPage.html",controller:"searchPageController"}).state("searchMain",{url:"/searchMain",templateUrl:"views/searchMain.html",controller:"searchMainController"})}]),app.controller("mainController",["$scope",function($scope){$scope.itemStore={}}]),app.controller("searchPageController",["$scope",function($scope){$scope.clearHistory=function(){$(".searchPage main ul").empty()},$scope.clearInput=function(){$(".searchPage header input").val("")}}]),app.controller("searchMainController",["$scope","searchService",function($scope,searchService){searchService.searchData().success(function(res){$scope.searchData=res.list})}]),app.controller("addressController",["$scope","addressService",function($scope,addressService){addressService.addressData().success(function(res){$scope.addressData=res["城市代码"]})}]),app.controller("allOrdersController",["$scope","$location",function($scope,$location){for(var a=angular.element(".hd a"),b=$location.path().split("/")[2],i=0;i<a.length;i++)if($(a).eq(i).hasClass(b)){$(a).eq(i).addClass("active").siblings().removeClass("active");break}/*
		获取元素的方式：以下方式写在函数里面，页面加载时不能触发，所以得单写上面页面加载时加class
			(1) angular.element("#")   引入jquery时可以用这种获取方式，不引入时得用原生DOM，括号里面写document.querySelector('#')或者别的获取方式
			(2) 获取当前所在点击元素，传递参数$event  函数里面$(event.target)
			(3) 用true或false的点击事件
			(4) 用toggleClass的自定义指令下的@，与link结合
			(5) 用ng-style，点击时调用函数，函数中自定义样式，改变样式
	*/
// (1)
$scope.addBorder=function(i){angular.element(".hd>a").removeClass("active"),
// 与jquery相关，选择时要用eq()选择，不能用[]，[]是选择数组的元素的
angular.element(".hd>a").eq(i).addClass("active")}}]);// 获取AngularJS程序
var app=angular.module("myApp");app.controller("carController",["$scope",function($scope){$scope.single="",$scope.add=function(e){1==$scope.count&&($scope.single="-"),$scope.count++,$scope.moneyT+=318},$scope.min=function(e){$scope.count--,1==$scope.count&&(e.currentTarget.innerHTML=""),$scope.moneyT-=318}}]),app.controller("carEmptyController",["$scope",function($scope){}]),app.controller("collectController",["$scope",function($scope){$scope.fn=function(i){angular.element(".list>a").parent().children("a").removeClass("active"),angular.element(".list>a").eq(i).addClass("active")}}]),app.controller("footerController",["$scope",function($scope){}]),app.controller("freshController",["$scope","freshService",function($scope,freshService){freshService.data().success(function(res){$scope.data=res,
// $scope.slide = res.slid;
$scope.hotArr=res.productOne,$scope.playLifeArr=res.combineColumnTow,$scope.title=res.productTwoTitle,$scope.selectArr=res.productTwo})}]),app.controller("girlLuggageCtrl",["$scope",function($scope){$scope.activity=function(idx){var navLi=$("li"),top=$(".title").eq(idx).offset().top;$.each(navLi,function(m,n){$(n).removeClass("activity")}),navLi.eq(idx).addClass("activity"),$("body").scrollTop(top)};var headerH=$("header").height(),navH=$("nav").height(),bannerH=$(".banner").height(),title1Top=$(".title").eq(0).offset().top,title2Top=$(".title").eq(1).offset().top,title3Top=$(".title").eq(2).offset().top;window.onscroll=function(){var scrollTop=$("body").scrollTop();scrollTop>headerH+bannerH-navH?$("nav").addClass("nav"):$("nav").removeClass("nav"),scrollTop>title1Top&&($("li").removeClass("activity"),$("li").eq(1).addClass("activity")),scrollTop>title2Top&&($("li").removeClass("activity"),$("li").eq(2).addClass("activity")),scrollTop>title3Top&&($("li").removeClass("activity"),$("li").eq(3).addClass("activity")),scrollTop<title1Top&&($("li").removeClass("activity"),$("li").eq(0).addClass("activity"))}}]),app.controller("recommendCtrl",["$scope","recommendSev",function($scope,recommendSev){recommendSev.recommendProducts().success(function(res){$scope.products=res.products})}]),app.controller("coachCtrl",["$scope","recommendSev",function($scope,recommendSev){recommendSev.coachProducts().success(function(res){$scope.products=res.products})}]),app.controller("mkCtrl",["$scope","recommendSev",function($scope,recommendSev){recommendSev.MKProducts().success(function(res){$scope.products=res.products})}]),app.controller("ksCtrl",["$scope","recommendSev",function($scope,recommendSev){recommendSev.KSProducts().success(function(res){$scope.products=res.products})}]),app.controller("globalController",["$scope","globalService",function($scope,globalService){globalService.swiper().success(function(res){$scope.swiper=res}),globalService.items().success(function(res){$scope.items=res})}]),app.controller("goodStoreCtrl",["$scope","goodStoreSev",function($scope,goodStoreSev){goodStoreSev.goodStoreImg().success(function(res){$scope.goodStoreImg=res.goodStoreImg}),$scope.activity=function(idx){for(var navLi=document.getElementsByTagName("li"),i=(document.getElementsByClassName("cBox"),0);i<navLi.length;i++)navLi[i].className="";navLi[idx].className="activity"}}]),app.controller("historyController",["$scope",function($scope){}]),app.controller("home2Controller",["$scope",function($scope){}]),app.controller("homeController",["$scope","homeService",function($scope,homeService){$scope.border=function(i){$("nav a").removeClass("border"),$("nav a").eq(i).addClass("border")},$(function(){
//根据剩余时间字符串计算出总秒数
function getTotalSecond(timestr){for(var reg=/\d+/g,timenums=new Array;null!=(r=reg.exec(timestr));)timenums.push(parseInt(r));var second=0,i=0;return 4==timenums.length&&(second+=24*timenums[0]*3600,i=1),second+=3600*timenums[i]+60*timenums[++i]+timenums[++i]}
//根据剩余秒数生成时间格式
function getNewSyTime(sec){var s=sec%60;sec=(sec-s)/60;//min
var m=sec%60;sec=(sec-m)/60;//hour
var h=sec%24,d=(sec-h)/24,syTimeStr="";return d>0&&(syTimeStr+=d.toString()+"天"),syTimeStr+=("0"+h.toString()).substr(-2)+":"+("0"+m.toString()).substr(-2)+":"+("0"+s.toString()).substr(-2)}var tid=setInterval(function(){var oTimebox=$("#timebox"),syTime=oTimebox.text(),totalSec=getTotalSecond(syTime)-1;totalSec>=0?oTimebox.text(getNewSyTime(totalSec)):clearInterval(tid)},1e3)}),homeService.items().success(function(res){$scope.products=res.list})}]),app.controller("impressCtrl",["$scope","impressSev",function($scope,impressSev){impressSev.impressProducts().success(function(res){$scope.products=res.products}),$scope.activity=function(idx){var navLi=$("li"),top=$(".cBox").eq(idx).offset().top,headerH=$("header").height();$.each(navLi,function(m,n){$(n).removeClass("activity")}),navLi.eq(idx).addClass("activity"),$("body").scrollTop(top-headerH)}}]),app.controller("indexController",["$scope",function($scope){}]),app.controller("itemDetailController",["$scope",function($scope){$scope.img=$scope.img,$scope.name=$scope.name,$scope.old=$scope.old,$scope.new=$scope.new}]),app.controller("monkeyEleController",["$scope","monkeyEleService",function($scope,monkeyEleService){monkeyEleService.getJson().success(function(res){$scope.hotArr=res.productOne,$scope.playLifeArr=res.combineColumnTow,$scope.title=res.productTwoTitle,$scope.selectArr=res.productTwo})}]),app.controller("monkeyFreController",["$scope","monkeyFreService",function($scope,monkeyFreService){monkeyFreService.getJson().success(function(res){$scope.hotArr=res.productOne,$scope.playLifeArr=res.combineColumnTow,$scope.title=res.productTwoTitle,$scope.selectArr=res.productTwo})}]),app.controller("MyCtrl",["$scope",function($scope){
// 点击时拿到当前商品的信息
$scope.goShopShow=function($event){
// console.log($event.target);//点击的地方不同目标元素不同
//使用jQuery
$scope.img=$(event.target).parents("dl").find("img").attr("src"),$scope.name=$(event.target).parents("dl").find("h3").html(),$scope.new=$(event.target).parents("dl").find(".new").html(),$scope.old=$(event.target).parents("dl").find(".old").html()}}]),app.controller("newController",["$scope","newService",function($scope,newService){newService.newProducts().success(function(res){$scope.products=res.products})}]),app.controller("popularityController",["$scope","popularityService",function($scope,popularityService){popularityService.popularityProducts().success(function(res){$scope.products=res.products})}]),app.controller("rushController",["$scope","rushService",function($scope,rushService){rushService.rushProducts().success(function(res){$scope.rushProducts=res.list})}]),app.controller("scoreController",["$scope",function($scope){$scope.fn=function(i){angular.element(".list>a").parent().children().removeClass("active"),angular.element(".list>a").eq(i).addClass("active")}}]),app.controller("secondNavController",["$scope",function($scope){
//首页顶部导航
$scope.tab=function(e){e.target.parent().toggleClass("active")}}]),app.controller("selfStoreCtrl",["$scope",function($scope){$scope.activity=function(idx){for(var navLi=document.getElementsByTagName("li"),i=0;i<navLi.length;i++)navLi[i].className="";navLi[idx].className="activity"}}]),app.controller("popCtrl",["$scope","selfStoreSev",function($scope,selfStoreSev){selfStoreSev.popPro().success(function(res){$scope.products=res.products})}]),app.controller("babyCtrl",["$scope","selfStoreSev",function($scope,selfStoreSev){selfStoreSev.babyPro().success(function(res){$scope.products=res.products})}]),app.controller("cosmeticCtrl",["$scope","selfStoreSev",function($scope,selfStoreSev){selfStoreSev.cosmeticPro().success(function(res){$scope.products=res.products})}]),app.controller("sortController",["$scope","sortService",function($scope,sortService){var li=$(".sort ul li");li.eq(0).addClass("bg"),$scope.bg=function(index){li.parent().children().removeClass("bg"),li.eq(index).addClass("bg")}}]),app.controller("swiperControlleri",["$scope","swiperService",function($scope,swiperService){$scope.sw1=function(){new Swiper(".swiper-container",{autoplay:2e3,//可选选项，自动滑动
autoplayDisableOnInteraction:!1,loop:!0,pagination:".swiper-pagination",paginationClickable:!0})},swiperService.swiperData1().success(function(res){$scope.swiperData1=res.swiper})}]),app.controller("swiperControllerii",["$scope","swiperService",function($scope,swiperService){$scope.sw2=function(){new Swiper(".swiper-container",{autoplay:2e3,//可选选项，自动滑动
autoplayDisableOnInteraction:!1,loop:!0,pagination:".swiper-pagination",paginationClickable:!0})},swiperService.swiperData2().success(function(res){$scope.swiperData2=res.slid})}]),app.controller("swiperControlleriii",["$scope","swiperService",function($scope,swiperService){$scope.sw3=function(){new Swiper(".swiper-container",{autoplay:2e3,//可选选项，自动滑动
autoplayDisableOnInteraction:!1,loop:!0,pagination:".swiper-pagination",paginationClickable:!0})},swiperService.swiperData3().success(function(res){$scope.swiperData3=res.slid})}]),app.controller("youController",["$scope",function($scope){}]),app.directive("footerDirective",function(){return{templateUrl:"views/footer.html",controller:"footerController"}}),app.directive("headerDirective",function(){return{templateUrl:"views/headerDirective.html"}}),app.directive("rushheaderDirective",function(){return{templateUrl:"views/rushHeaderDirective.html"}}),app.directive("mySwiper",function(){return{templateUrl:"views/mySwiper.html",controller:"swiperController"}}),app.directive("recommendDir",function(){return{controller:"recommendCtrl",scope:!0,templateUrl:"views/products.html"}}),app.directive("coachDir",function(){return{controller:"coachCtrl",scope:!0,templateUrl:"views/products.html"}}),app.directive("mkDir",function(){return{controller:"mkCtrl",scope:!0,templateUrl:"views/products.html"}}),app.directive("ksDir",function(){return{controller:"ksCtrl",scope:!0,templateUrl:"views/products.html"}}),app.directive("secondNav",function(){return{templateUrl:"views/secondNav.html",controller:"secondNavController"}}),app.directive("babyDir",function(){return{controller:"babyCtrl",scope:!0,templateUrl:"views/selfPro.html"}}),app.directive("cosmeticDir",function(){return{controller:"cosmeticCtrl",scope:!0,templateUrl:"views/selfPro.html"}}),app.directive("popDir",function(){return{controller:"popCtrl",scope:!0,templateUrl:"views/selfPro.html"}}),app.directive("swiperDirectivei",function(){return{templateUrl:"views/swiper1.html",controller:"swiperControlleri"}}),app.directive("swiperDirectiveii",function(){return{templateUrl:"views/swiper2.html",controller:"swiperControllerii"}}),app.directive("swiperDirectiveiii",function(){return{templateUrl:"views/swiper3.html",controller:"swiperControlleriii"}}),app.service("addressService",["$http",function($http){this.addressData=function(){return $http.get("public/json/city.json")}}]),app.service("freshService",["$http",function($http){this.data=function(){return $http.get("public/json/car.json")}}]),app.service("recommendSev",["$http",function($http){this.recommendProducts=function(){return $http.get("public/json/lightImpress/recommend.json")},this.coachProducts=function(){return $http.get("public/json/lightImpress/coach.json")},this.MKProducts=function(){return $http.get("public/json/lightImpress/MK.json")},this.KSProducts=function(){return $http.get("public/json/lightImpress/KS.json")}}]),app.service("globalService",["$http",function($http){this.swiper=function(){return $http.get("public/json/swiper.json")},this.items=function(){return $http.get("public/json/select1.json")}}]),app.service("goodStoreSev",["$http",function($http){this.goodStoreImg=function(){return $http.get("public/json/goodStore/goodStore.json")}}]),app.service("homeService",["$http",function($http){this.swiper=function(){return $http.get("public/json/swiper.json")},this.items=function(){return $http.get("public/json/select1.json")}}]),app.service("impressSev",["$http",function($http){this.impressProducts=function(){return $http.get("public/json/lightImpress/lightImpress.json")}}]),app.service("monkeyEleService",["$http",function($http){this.getJson=function(){
// return $http.get("http://api.mall.yunhou.com/Widgets/widgetget?method=getWidgetData&activeId=22209&_=1477713105859&callback=jsonp2")
return $http.get("public/json/car.json")}}]),app.service("monkeyFreService",["$http",function($http){this.getJson=function(){
// return $http.get("http://api.mall.yunhou.com/Widgets/widgetget?method=getWidgetData&activeId=22209&_=1477713105859&callback=jsonp2")
return $http.get("public/json/car.json")}}]),app.service("newService",["$http",function($http){
// this.newData = function (){
// 	return $http.get('public/json/new.json');
// };
this.newProducts=function(){return $http.get("public/json/newProduct.json")}}]),app.service("popularityService",["$http",function($http){this.popularityProducts=function(){return $http.get("public/json/popImgs.json")}}]),app.service("rushService",["$http",function($http){this.rushProducts=function(res){return $http.get("public/json/select1.json")}}]),app.service("searchService",["$http",function($http){this.searchData=function(){return $http.get("public/json/select1.json")}}]),app.service("selfStoreSev",["$http",function($http){this.popPro=function(){return $http.get("public/json/goodStore/pop.json")},this.babyPro=function(){return $http.get("public/json/goodStore/baby.json")},this.cosmeticPro=function(){return $http.get("public/json/goodStore/cosmetic.json")}}]),app.service("sortService",["$http",function($http){this.nav=function(){}}]),app.service("swiperService",["$http",function($http){this.swiperData1=function(){return $http.get("public/json/swiper.json")},this.swiperData2=function(){return $http.get("public/json/car.json")},this.swiperData3=function(){return $http.get("public/json/car1.json")}}]);
/*最后修改人: zhu*/